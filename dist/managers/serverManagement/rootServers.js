import { readAndParse } from "/lib/helpers";
import { globalFiles } from "/lib/constants";
import { getFilteredServerMap } from "/managers/serverManagement/serverHelpers";
import { updateServerMap } from "/managers/serverManager";
/** @RAM 0 GB */
export async function allServersRooted(ns) {
    const curServerMap = await readAndParse(ns, globalFiles.serverMap);
    return curServerMap.every((adminRights) => adminRights.hasAdminRights === false);
}
/** @RAM 0.05 GB */
export async function rootWhatWeCan(ns) {
    const curServerMap = await readAndParse(ns, globalFiles.serverMap);
    const filteredByAdminRights = await getFilteredServerMap(curServerMap, 'hasAdminRights', '===', false);
    for (const currentServer of filteredByAdminRights) {
        if (currentServer.numOpenPortsRequired !== undefined &&
            currentServer.openPortCount !== undefined &&
            currentServer.numOpenPortsRequired <= currentServer.openPortCount) {
            await ns.nuke(currentServer.hostName);
        }
    }
    await updateServerMap(ns);
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicm9vdFNlcnZlcnMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvbWFuYWdlcnMvc2VydmVyTWFuYWdlbWVudC9yb290U2VydmVycy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFFQSxPQUFPLEVBQUUsWUFBWSxFQUFFLE1BQU0sY0FBYyxDQUFDO0FBQzVDLE9BQU8sRUFBRSxXQUFXLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUM3QyxPQUFPLEVBQUUsb0JBQW9CLEVBQUUsTUFBTSwwQ0FBMEMsQ0FBQztBQUNoRixPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0seUJBQXlCLENBQUM7QUFFMUQsZ0JBQWdCO0FBQ2hCLE1BQU0sQ0FBQyxLQUFLLFVBQVUsZ0JBQWdCLENBQUMsRUFBSztJQUN4QyxNQUFNLFlBQVksR0FBdUIsTUFBTSxZQUFZLENBQUMsRUFBRSxFQUFDLFdBQVcsQ0FBQyxTQUFTLENBQUMsQ0FBQztJQUN0RixPQUFPLFlBQVksQ0FBQyxLQUFLLENBQUMsQ0FBQyxXQUFXLEVBQUUsRUFBRSxDQUFDLFdBQVcsQ0FBQyxjQUFjLEtBQUssS0FBSyxDQUFDLENBQUM7QUFDckYsQ0FBQztBQUVELG1CQUFtQjtBQUNuQixNQUFNLENBQUMsS0FBSyxVQUFVLGFBQWEsQ0FBQyxFQUFLO0lBQ3JDLE1BQU0sWUFBWSxHQUF1QixNQUFNLFlBQVksQ0FBQyxFQUFFLEVBQUMsV0FBVyxDQUFDLFNBQVMsQ0FBQyxDQUFDO0lBQ3RGLE1BQU0scUJBQXFCLEdBQXVCLE1BQU0sb0JBQW9CLENBQUMsWUFBWSxFQUFDLGdCQUFnQixFQUFDLEtBQUssRUFBQyxLQUFLLENBQUMsQ0FBQztJQUN4SCxLQUFJLE1BQU0sYUFBYSxJQUFJLHFCQUFxQixFQUFDO1FBQzdDLElBQUcsYUFBYSxDQUFDLG9CQUFvQixLQUFLLFNBQVM7WUFDL0MsYUFBYSxDQUFDLGFBQWEsS0FBSyxTQUFTO1lBQ3pDLGFBQWEsQ0FBQyxvQkFBb0IsSUFBSSxhQUFhLENBQUMsYUFBYSxFQUFDO1lBQzlELE1BQU0sRUFBRSxDQUFDLElBQUksQ0FBQyxhQUFhLENBQUMsUUFBUSxDQUFDLENBQUM7U0FDekM7S0FDUjtJQUNELE1BQU0sZUFBZSxDQUFDLEVBQUUsQ0FBQyxDQUFDO0FBQzlCLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOUyB9IGZyb20gXCJAbnNcIjtcclxuaW1wb3J0IHsgc2VydmVyT2JqZWN0IH0gZnJvbSBcIi9jbGFzc2VzL2NsYXNzU2VydmVyXCI7XHJcbmltcG9ydCB7IHJlYWRBbmRQYXJzZSB9IGZyb20gXCIvbGliL2hlbHBlcnNcIjtcclxuaW1wb3J0IHsgZ2xvYmFsRmlsZXMgfSBmcm9tIFwiL2xpYi9jb25zdGFudHNcIjtcclxuaW1wb3J0IHsgZ2V0RmlsdGVyZWRTZXJ2ZXJNYXAgfSBmcm9tIFwiL21hbmFnZXJzL3NlcnZlck1hbmFnZW1lbnQvc2VydmVySGVscGVyc1wiO1xyXG5pbXBvcnQgeyB1cGRhdGVTZXJ2ZXJNYXAgfSBmcm9tIFwiL21hbmFnZXJzL3NlcnZlck1hbmFnZXJcIjtcclxuXHJcbi8qKiBAUkFNIDAgR0IgKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGFsbFNlcnZlcnNSb290ZWQobnM6TlMpOlByb21pc2U8Ym9vbGVhbj57XHJcbiAgICBjb25zdCBjdXJTZXJ2ZXJNYXA6QXJyYXk8c2VydmVyT2JqZWN0PiA9IGF3YWl0IHJlYWRBbmRQYXJzZShucyxnbG9iYWxGaWxlcy5zZXJ2ZXJNYXApO1xyXG4gICAgcmV0dXJuIGN1clNlcnZlck1hcC5ldmVyeSgoYWRtaW5SaWdodHMpID0+IGFkbWluUmlnaHRzLmhhc0FkbWluUmlnaHRzID09PSBmYWxzZSk7XHJcbn1cclxuXHJcbi8qKiBAUkFNIDAuMDUgR0IgKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJvb3RXaGF0V2VDYW4obnM6TlMpOlByb21pc2U8dm9pZD57XHJcbiAgICBjb25zdCBjdXJTZXJ2ZXJNYXA6QXJyYXk8c2VydmVyT2JqZWN0PiA9IGF3YWl0IHJlYWRBbmRQYXJzZShucyxnbG9iYWxGaWxlcy5zZXJ2ZXJNYXApO1xyXG4gICAgY29uc3QgZmlsdGVyZWRCeUFkbWluUmlnaHRzOkFycmF5PHNlcnZlck9iamVjdD4gPSBhd2FpdCBnZXRGaWx0ZXJlZFNlcnZlck1hcChjdXJTZXJ2ZXJNYXAsJ2hhc0FkbWluUmlnaHRzJywnPT09JyxmYWxzZSk7XHJcbiAgICBmb3IoY29uc3QgY3VycmVudFNlcnZlciBvZiBmaWx0ZXJlZEJ5QWRtaW5SaWdodHMpe1xyXG4gICAgICAgIGlmKGN1cnJlbnRTZXJ2ZXIubnVtT3BlblBvcnRzUmVxdWlyZWQgIT09IHVuZGVmaW5lZCAmJiBcclxuICAgICAgICAgICAgY3VycmVudFNlcnZlci5vcGVuUG9ydENvdW50ICE9PSB1bmRlZmluZWQgJiYgXHJcbiAgICAgICAgICAgIGN1cnJlbnRTZXJ2ZXIubnVtT3BlblBvcnRzUmVxdWlyZWQgPD0gY3VycmVudFNlcnZlci5vcGVuUG9ydENvdW50KXtcclxuICAgICAgICAgICAgICAgIGF3YWl0IG5zLm51a2UoY3VycmVudFNlcnZlci5ob3N0TmFtZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgIH1cclxuICAgIGF3YWl0IHVwZGF0ZVNlcnZlck1hcChucyk7XHJcbn1cclxuIl19